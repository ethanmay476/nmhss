"0","years <- unique(data_start_2014_filter$YEAR)"
"0",""
"0","for (year in years) {"
"0","  cat(""\\pagebreak"")"
"0","  cat(sprintf(""## Statistical Analysis for %s \n"", year))"
"0","  "
"0","  data_year <- filter(data_start_2014_filter, YEAR == year) %>% "
"0","               select(which(sapply(., is_binary_factor))) %>%"
"0","               mutate_if(is.numeric, as.factor)"
"0","  "
"0","  target_var <- ""SRVC62"""
"0","  other_vars <- setdiff(names(data_year), target_var)"
"0","  "
"0","  results <- list()"
"0","  "
"0","  for (var in other_vars) {"
"0","    if (var != ""YEAR"") {"
"0","      chi_square_result <- perform_chi_square(data_year, target_var, var)"
"0","      two_prop_z_result <- perform_two_prop_z_test(data_year, target_var, var)"
"0","      "
"0","      # Filter out unnecessary columns here"
"0","      chi_square_result <- chi_square_result %>%"
"0","                           select(-statistic, -method) # Exclude 'statistic' and 'method'"
"0","      two_prop_z_result <- two_prop_z_result %>%"
"0","                           select(-statistic, -method) # Exclude 'statistic' and 'method'"
"0","      "
"0","      # Combine results"
"0","      combined_results <- bind_rows(Chi_square = chi_square_result, "
"0","                                    Two_prop_Z = two_prop_z_result, "
"0","                                    .id = ""Test"")"
"0","      combined_results$Variable <- var"
"0","      "
"0","      results[[var]] <- combined_results"
"0","    }"
"0","  }"
"0","  "
"0","  # Combine all results into a single dataframe"
"0","  final_results <- bind_rows(results, .id = ""Comparison"")"
"0","  "
"0","  # Exclude the 'df' (degrees of freedom) and 'method' columns from the final table"
"0","  final_results <- final_results %>% "
"0","                   select(-df, -method) # Add or remove column names as needed"
"0","  "
"0","  # Output the results for this year"
"0","  print(kable(final_results, caption = sprintf(""Statistical Analysis for Year %s"", year)) %>% "
"0","          kable_styling(bootstrap_options = c(""striped"", ""hover"")))"
"0","}"
"1","\pagebreak"
"1","## Statistical Analysis for 2014 
"
"1","[1m[33mError[39m in `select()`:[22m
[33m![39m Can't subset columns that don't exist.
[31mâœ–[39m Column `df` doesn't exist.
Backtrace:
[90m 1. [39mfinal_results %>% select(-df, -method)
[90m 3. [39m[1m[94mdplyr:::select.data.frame([39m[22m., -df, -method[1m[94m)[39m[22m
"
